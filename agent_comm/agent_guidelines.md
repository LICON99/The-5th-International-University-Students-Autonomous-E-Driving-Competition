# Agent 협업 가이드라인

## 📋 작업 시작 시 필수 확인 사항

모든 Agent는 작업 시작 시 다음 파일들을 **반드시** 읽어야 합니다:

1. **자신의 프로필**: `agent1_profile.md` 또는 `agent2_profile.md`
   - 현재 작업 상태 확인
   - 담당 패키지 확인
   - 이전 작업 로그 파악

2. **공유 상태**: `shared_state.md`
   - 다른 Agent의 현재 상태 확인
   - 긴급 요청사항 확인
   - 공유 결정사항 확인

3. **이 가이드라인**: `agent_guidelines.md`
   - 협업 규칙 숙지

---

## 📝 작업 로그 자동 업데이트 규칙

### 업데이트해야 할 내용

다음과 같은 **중요한 답변** 후에는 자신의 프로필 파일을 업데이트합니다:

✅ **반드시 업데이트**:
1. **기술적 결정 사항**
   - 예: "Option 1 선택: Patchwork++ 코드에 직접 추가"
   - 예: "Euclidean Clustering 사용하기로 결정"

2. **코드 변경 사항**
   - 파일 수정, 새 함수 추가, 패키지 생성
   - 변경한 파일 경로와 주요 내용

3. **발견한 문제와 해결 방법**
   - 예: "Patchwork++는 이미 컴포넌트로 빌드되어 있음"
   - 예: "Intra-process 위해서는 ros2 component 사용 필요"

4. **작업 완료 체크리스트 업데이트**
   - `- [x]` 완료 표시
   - `- [ ]` 진행 중 또는 대기

5. **중요한 개념 설명/Q&A**
   - 사용자가 이해한 핵심 개념
   - 반복해서 참고할 만한 내용

⏭️ **건너뛰기**:
- 단순 확인 질문 ("진행할까요?")
- 짧은 응답 ("알겠습니다")
- 중복된 내용

### 업데이트 형식

```markdown
### YYYY-MM-DD (시간대별 추가)

**[작업 제목]**

**주요 내용**:
- 항목 1
- 항목 2

**코드 변경**:
- 파일: /path/to/file.cpp
- 내용: 함수 추가, 파라미터 수정 등

**다음 단계**: 무엇을 할 것인지
```

---

## 🤝 Agent 간 커뮤니케이션

### 다른 Agent에게 요청할 때

자신의 프로필 파일에 기록:
```markdown
## Agent 2에게 전달사항
- [2026-02-08] LiDAR 장애물 좌표를 /obstacles 토픽으로 퍼블리시 시작
- [2026-02-08] 카메라 좌표계와 LiDAR 좌표계 캘리브레이션 필요
```

### 다른 Agent로부터 받았을 때

자신의 프로필 파일에 기록:
```markdown
## Agent 2로부터 받은 사항
- [2026-02-08] 차선 중심선 좌표 받음 (/lane_center 토픽)
- [2026-02-08] 카메라-LiDAR TF 설정 완료
```

### shared_state.md 업데이트

작업 상태가 변경될 때마다:
```markdown
## Agent 1 (LiDAR) 상태
- **상태**: 작업 중 / 대기 / 테스트 중
- **현재 작업**: 구체적인 작업 내용
- **최근 완료**: 방금 완료한 작업
```

---

## 🔄 작업 인수인계

### 세션 종료 시

다음 세션을 위해 명확히 기록:

```markdown
**현재 진행 상황**:
- 완료: ROI Filtering 구현 완료
- 진행 중: Clustering 코드 작성 중 (50% 완료)
- 대기: Bounding Box 생성

**다음 작업**:
1. Clustering 코드 완성 (EstimateGround 함수에 추가)
2. 테스트 데이터로 검증
3. RViz2 시각화

**주의사항**:
- VLP-16 포인트가 적어서 Voxel Downsampling 건너뜀
- Clustering tolerance 0.3m로 설정 (경진대회 환경 고려)
```

### 새 세션 시작 시

1. 프로필 파일 읽고 "현재 진행 상황" 확인
2. "다음 작업" 항목부터 시작
3. "주의사항" 숙지

---

## ⚠️ 긴급 요청/블로킹 이슈

다른 Agent의 작업이 필요한 경우:

**shared_state.md**에 기록:
```markdown
## 긴급 요청
- [Agent 1 → Agent 2] 카메라 캘리브레이션 파일 필요 (LiDAR-Camera 퓨전 블로킹)
- [Agent 2 → Agent 1] 장애물 바운딩 박스 토픽 필요 (차선 회피 알고리즘 블로킹)
```

---

## 📊 공유 결정사항

두 Agent 모두 알아야 할 중요한 결정:

**shared_state.md**에 기록:
```markdown
## 공유 결정사항
- [2026-02-08] 좌표계 통일: base_link 기준 사용
- [2026-02-08] 장애물 토픽명: /obstacles (geometry_msgs/PoseArray)
- [2026-02-08] Intra-process 위해 모든 노드 컴포넌트로 구현
```

---

## 🧪 통합 테스트

LiDAR + Camera 통합 작업 시:

**shared_state.md**에 기록:
```markdown
## 통합 테스트 기록

### 2026-02-08 Test #1
- **목적**: LiDAR 장애물 + 카메라 차선 퓨전
- **결과**: 성공 / 실패
- **문제점**: 좌표계 불일치
- **해결**: TF 설정 수정
- **다음**: 실제 차량 테스트
```

---

## 📁 파일 구조 요약

```
~/ev_ws/agent_comm/
├── agent_guidelines.md      ← 이 파일 (공통 규칙)
├── agent1_profile.md         ← Agent 1 전용 (LiDAR)
├── agent2_profile.md         ← Agent 2 전용 (Camera)
└── shared_state.md           ← 실시간 공유 상태
```

---

## ✅ 체크리스트

작업 시작 전:
- [ ] 자신의 프로필 파일 읽음
- [ ] shared_state.md 읽음
- [ ] 다른 Agent의 긴급 요청 확인

작업 중:
- [ ] 중요한 결정 시 프로필 파일 업데이트
- [ ] 코드 변경 시 프로필 파일 업데이트
- [ ] 상태 변경 시 shared_state.md 업데이트

작업 종료 시:
- [ ] 진행 상황 기록
- [ ] 다음 작업 명시
- [ ] 주의사항 기록
- [ ] shared_state.md 상태 업데이트
